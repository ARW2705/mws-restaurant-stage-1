"use strict";var map,restaurant=void 0;window.initMap=function(){fetchRestaurantFromURL(function(e,n){e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:n.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})},window.fetchRestaurantFromURL=function(r){if(self.restaurant)r(null,self.restaurant);else{var n=getParameterByName("id");if(n)DBHelper.fetchRestaurantById(n,function(e,t){(self.restaurant=t)?DBHelper.getReviewsByRestaurantId(n,function(e,n){(self.reviews=n)?(fillRestaurantHTML(),r(null,t)):console.error(e)}):console.error(e)});else{r("No restaurant id in URL",null)}}},window.fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant;document.getElementById("restaurant-name").innerHTML=e.name;var n=document.getElementById("restaurant-address"),t=e.address.indexOf(",")+1,r=[e.address.slice(0,t),"<br>",e.address.slice(t)].join("");n.innerHTML=r;var a=document.getElementById("restaurant-img"),i=document.getElementById("picture-source"),d=document.getElementById("picture-img");a.className="restaurant-img";var l=DBHelper.imageUrlForRestaurant(e).substring(4);i.srcset="img/sizes/sm-"+l+".webp 360w,\n                  img/sizes/md-"+l+".webp 480w,\n                  img/sizes/lg-"+l+".webp 800w,\n                  img/sizes/lg-"+l+".webp 2x",d.alt=""+e.name,d.srcset="img/sizes/sm-"+l+".jpg 360w,\n                  img/sizes/md-"+l+".jpg 480w,\n                  img/sizes/lg-"+l+".jpg 800w,\n                  img/sizes/lg-"+l+".jpg 2x",document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},window.fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,n=document.getElementById("restaurant-hours");for(var t in e){var r=document.createElement("tr"),a=document.createElement("td");a.innerHTML=t,a.setAttribute("valign","top"),r.appendChild(a);var i=document.createElement("td"),d=e[t],l=d.indexOf(",")+1;if(0<l){var m=[d.slice(0,l),"<br>",d.slice(l)].join("");i.innerHTML=m}else i.innerHTML=e[t];r.appendChild(i),n.appendChild(r)}},window.fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.reviews,n=document.getElementById("reviews-container"),t=document.createElement("h3");if(t.innerHTML="Reviews",n.appendChild(t),e){var r=document.getElementById("reviews-list");e.forEach(function(e){r.appendChild(createReviewHTML(e))}),n.appendChild(r)}else{var a=document.createElement("p");a.innerHTML="No reviews yet!",n.appendChild(a)}createReviewForm()},window.createReviewForm=function(){var e=document.getElementById("reviews-container"),n=document.createElement("div");n.className="review-form-container";var t=document.createElement("form");t.id="review-form",t.name="review-form";var r=document.createElement("h4");r.innerHTML="Submit a Review",n.appendChild(r);var a=document.createElement("div");a.className="review-name-container";var i=document.createElement("label");i.for="reviewer-name",i.innerHTML="Your name",a.appendChild(i);var d=document.createElement("input");d.type="text",d.name="reviewer-name",d.id="reviewer-name",d.placeholder="Enter your name here",d.addEventListener("change",function(e){e.preventDefault(),checkFormValidation()}),a.appendChild(d),t.appendChild(a);var l=document.createElement("div");l.className="review-rating-slider-container";var m=document.createElement("label");m.for="rating-slider",m.innerHTML="Your rating ",m.id="rating-slider-label";var o=document.createElement("span");o.innerHTML="★★★★★",o.id="slider-value",m.appendChild(o),l.appendChild(m);var c=document.createElement("input");c.type="range",c.min=1,c.max=5,c.value=5,c.step=1,c.name="rating",c.id="rating",c.addEventListener("change",function(e){e.preventDefault(),document.getElementById("slider-value").innerHTML="★".repeat(e.target.value)}),l.appendChild(c),t.appendChild(l);var u=document.createElement("div");u.className="review-body-container";var s=document.createElement("label");s.innerHTML="Comments",s.for="review-body",u.appendChild(s);var p=document.createElement("textarea");p.name="comments",p.id="review-body",p.placeholder="Enter your comments here",p.addEventListener("change",function(e){e.preventDefault(),checkFormValidation()}),u.appendChild(p),t.appendChild(u);var v=document.createElement("button");v.innerHTML="Submit",v.id="review-submit-button",v.disabled=!0,v.addEventListener("click",function(e){e.preventDefault(),console.log("submitted")}),t.appendChild(v),n.appendChild(t),e.appendChild(n)},window.checkFormValidation=function(){var e=document.getElementById("review-form"),n=e["reviewer-name"].value,t=e["review-body"].value;document.getElementById("review-submit-button").disabled=!n||!t},window.handleReviewSubmission=function(){var e=document.getElementById("review-form"),n=e["reviewer-name"].value,t=e.rating.value,r=e["review-body"].value,a={restaurant_id:self.restaurant.id,name:n,rating:t,comments:r};DBHelper.addReview(a)},window.createReviewHTML=function(e){var n=document.createElement("li"),t=document.createElement("div");t.className="review-card-header";var r=document.createElement("div");r.className="review-card-body";var a=document.createElement("p");a.innerHTML=e.name,t.appendChild(a);var i=document.createElement("time"),d=new Date(e.updatedAt);i.innerHTML=getFormattedTimestamp(d),t.appendChild(i),n.appendChild(t);var l=document.createElement("p");l.innerHTML="Rating: "+"★".repeat(e.rating),r.appendChild(l);var m=document.createElement("article");return m.innerHTML=e.comments,r.appendChild(m),n.appendChild(r),n},window.getFormattedTimestamp=function(e){var n=e.getDate(),t=e.getMonth(),r=e.getFullYear();return["Jan","Feb","Mar","Apr","May","June","July","Aug","Sep","Oct","Nov","Dec"][t]+" "+n+", "+r},window.fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,n=document.getElementById("breadcrumb");n.lastElementChild.removeAttribute("aria-current");var t=document.createElement("li");t.innerHTML=e.name,t.setAttribute("aria-current","page"),n.appendChild(t)},window.getParameterByName=function(e,n){n||(n=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(n);return t?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null};